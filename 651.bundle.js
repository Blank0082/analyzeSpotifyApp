"use strict";(self.webpackChunkanalyze_spotify_app=self.webpackChunkanalyze_spotify_app||[]).push([[651],{1651:(e,o,t)=>{t.r(o),t.d(o,{default:()=>d});var n=t(7767),r=t(6540),c=t(1087),s=t(4285),a=t(4848);const i={get access_token(){return localStorage.getItem("access_token")||null},save:function(e){const{access_token:o,refresh_token:t}=e;localStorage.setItem("access_token",o),localStorage.setItem("refresh_token",t)}};function d(){const e=(0,n.Zp)();(0,r.useEffect)((()=>{if(window.opener||(0,s.A)()){const t=new URLSearchParams(window.location.search),n=t.get("code"),r=t.get("error");n?o(n).then((o=>{o&&o.access_token&&(i.save(o),window.opener&&(window.opener.postMessage({type:"authorized"},"*"),window.close()),e("/playlists"))})).catch((o=>{console.error("Error fetching access token:",o),window.opener&&(window.opener.postMessage({type:"AUTH_ERROR",error:o},"*"),window.close()),e("/")})):r&&(window.opener&&(window.opener.postMessage({type:"AUTH_ERROR",error:r},"*"),window.close()),e("/"))}else e("/")}),[e]);const o=async e=>{const o=localStorage.getItem("code_verifier"),t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:c.A.client_id,grant_type:"authorization_code",code:e,redirect_uri:c.A.redirect_uri,code_verifier:o})});return await t.json()};return(0,a.jsx)("div",{children:"Loading..."})}},1087:(e,o,t)=>{t.d(o,{A:()=>n});const n={redirect_uri:"undefined/callback",client_id:void 0,scope:void 0}},4285:(e,o,t)=>{function n(){return/Mobi|Android/i.test(navigator.userAgent)}t.d(o,{A:()=>n})}}]);