"use strict";(self.webpackChunkanalyze_spotify_app=self.webpackChunkanalyze_spotify_app||[]).push([[651],{1651:(e,o,t)=>{t.r(o),t.d(o,{default:()=>d});var r=t(7767),n=t(6540),a=t(1087),s=t(4285),c=t(4848);const i={get access_token(){return localStorage.getItem("access_token")||null},save:function(e){const{access_token:o,refresh_token:t}=e;localStorage.setItem("access_token",o),localStorage.setItem("refresh_token",t)}};function d(){const e=(0,r.Zp)();(0,n.useEffect)((()=>{if(window.opener||(0,s.A)()){const t=new URLSearchParams(window.location.search),r=t.get("code"),n=t.get("error");r?o(r).then((o=>{o&&o.access_token&&(i.save(o),window.opener&&(window.opener.postMessage({type:"authorized"},"*"),window.close()),e("/playlists"))})).catch((o=>{console.error("Error fetching access token:",o),window.opener&&(window.opener.postMessage({type:"AUTH_ERROR",error:o},"*"),window.close()),e("/")})):n&&(window.opener&&(window.opener.postMessage({type:"AUTH_ERROR",error:n},"*"),window.close()),e("/"))}else e("/")}),[e]);const o=async e=>{const o=localStorage.getItem("code_verifier"),t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:a.A.client_id,grant_type:"authorization_code",code:e,redirect_uri:a.A.redirect_uri,code_verifier:o})});return await t.json()};return(0,c.jsx)("div",{children:"Loading..."})}},1087:(e,o,t)=>{t.d(o,{A:()=>r});const r={redirect_uri:"http://localhost:3000/callback",client_id:"ebf1bf4571374afa83e28c5c465bf0e6",scope:"user-read-private user-read-email playlist-read-private user-library-read"}},4285:(e,o,t)=>{function r(){return/Mobi|Android/i.test(navigator.userAgent)}t.d(o,{A:()=>r})}}]);